# 📦 컨테이너 반입량 예측 AI 서비스

## 📝 서비스 설명
본 서비스는 **과거 5년간의 일별 컨테이너 반입 건수**와 해당 날짜의 **기상 데이터**(평균 기온, 최저 기온, 최고 기온, 강수량, 풍속, 습도)를 기반으로 학습한 회귀 모델을 통해 **당일을 포함한 8일치의 컨테이너 반입 건수**를 예측하는 AI 서비스입니다.

OpenWeatherMap API를 활용하여 **실시간 날씨 예측 데이터**를 수집하며, 해당 데이터를 바탕으로 향후 8일간의 물동량 수요를 예측합니다.

---

## 🚀 실행 방법

1. **API Key 설정**

    - 프로젝트 루트 디렉토리에 .env 파일 생성 후 아래와 같이 입력
`API_KEY=your_openweathermap_api_key`

2. **필요 라이브러리 설치**

```bash
pip install -r requirements.txt
```

3. **FastAPI 실행**

```bash
uvicorn main:app --reload
```

---

## 📊 모델 성능

| 모델 구성                                | MAPE (%)  |
| ------------------------------------ | --------- |
| LightGBM 단독                          | 38.64     |
| LightGBM + CatBoost + MLP (Optuna X) | 37.11     |
| ✅ LightGBM + CatBoost + MLP + Optuna | **35.32** |

- 최종 선택한 모델은 **Optuna를 활용한 LightGBM + CatBoost + MLP 앙상블 모델**입니다.

- Optuna 없이 앙상블만 사용했을 경우 **MAPE 37.11%**로 성능에 한계가 있어, **하이퍼파라미터 튜닝 도구인 Optuna를 도입**하여 **최종적으로 MAPE 35.32%**까지 개선하였습니다.

## ⚠️ 이슈 및 한계

**🔸 단일 모델 성능의 한계**

![2](https://i.ibb.co/yBmqcqmW/2.png)

- LightGBM 단독 사용 시 **MAPE 38.64%**로 낮은 예측 정확도를 보임

**🔸 단순 앙상블의 제한**

![4](https://i.ibb.co/yFvYK8dy/4.png)

- LightGBM + CatBoost + MLP를 앙상블해도 **MAPE 37.11%**로 큰 성능 향상이 없었음

**🔸 Optuna 도입의 효과**

![5](https://i.ibb.co/RTnNQ8XN/5.png)

![6](https://i.ibb.co/60VkC6Dn/6.png)

- Optuna를 활용한 하이퍼파라미터 최적화 후 **MAPE 35.32%**로 성능이 개선됨

---

## 📉 파생 변수 기반 실험 (참고용)

![1](https://i.ibb.co/27qtZvkV/1.png)

다음과 같은 **시계열 및 그룹 통계 기반 파생 변수**를 추가하여 딥러닝 모델을 학습했을 경우, **MAPE 2.95%**로 매우 높은 성능을 기록했습니다.

**사용된 주요 파생 변수:**

- 전일 입고 물량

- 최근 3일간 평균 입고 물량 (전일 기준)

- 최근 7일간 평균 입고 물량 (전일 기준)

- 전일 대비 입고 물량 증감

- 전일 대비 입고 물량 증감률

- 일주일 전 대비 입고 물량 증감

- 요일별 평균 입고 물량

- 월별 평균 입고 물량

⚠️ 그러나 해당 변수들을 생성하기 위한 과거 시계열 데이터 확보가 어려워 실제 모델에는 적용하지 못했습니다.
📈 추후 관련 데이터를 제공하는 API가 확보될 경우, 위 파생 변수를 활용한 고성능 모델 적용이 가능할 것으로 기대됩니다.

---

## 📮 향후 개선 방향

- 물류 및 항만 운영 관련 외부 API 연동 검토

- 실시간 예측 결과를 활용한 **자동 물류 계획 추천 기능** 추가

- **서버리스 환경 배포(AWS Lambda 등)** 및 모바일 클라이언트 연계